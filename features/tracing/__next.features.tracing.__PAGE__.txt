1:"$Sreact.fragment"
2:I[55169,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/73350e696300078d.js","/_next/static/chunks/3a4fb10029fc91d1.js","/_next/static/chunks/e0afa020722afb62.js"],"TOCProvider"]
3:I[769,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/73350e696300078d.js","/_next/static/chunks/3a4fb10029fc91d1.js","/_next/static/chunks/e0afa020722afb62.js"],"Sidebar"]
4:I[47486,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/73350e696300078d.js","/_next/static/chunks/3a4fb10029fc91d1.js","/_next/static/chunks/e0afa020722afb62.js"],"ClientWrapper"]
23:I[63894,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/73350e696300078d.js","/_next/static/chunks/3a4fb10029fc91d1.js","/_next/static/chunks/e0afa020722afb62.js"],"HeadingAnchor"]
24:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/7340adf74ff47ec0.js"],"OutletBoundary"]
25:"$Sreact.suspense"
5:T94a,---
sidebar_position: 1
---

# Tracing

Tracing is the raw data layer. It records what your agent did, in the exact order it happened.

Marlo does not infer or guess. If an event is not captured, it does not exist in the trace.

## What Tracing Captures
For every task, Marlo stores a full sequence of events:

- `agent_definition`: system prompt, tools, MCP servers, model config
- `task_start`: task text and metadata
- `llm_call`: messages, model params, response, usage, reasoning
- `tool_call`: tool name, input, output, error
- `log`: any extra metadata you want to attach
- `task_end`: status and final answer

Each event also includes:
- `agent_id`: the agent that produced the event
- `parent_agent_id`: the parent agent, if this is a sub‑agent
- `invocation_id`: trace id for the run
- `run_id`: session id
- `task_id`: task id inside the session

This is enough to rebuild the agent tree and the full timeline for every task.

## Why Tracing Is Required
Rewards and learning are built from traces. If you skip tool calls or LLM calls, the judge sees an incomplete picture and the learning quality drops.

So these are mandatory:
- `llm_call` for every model call
- `tool_call` for every tool call

## Agent Definition Is Not Optional
Marlo needs the full agent definition to judge and learn correctly:
- The system prompt gives the policy context
- Tool definitions explain what tools exist and how to use them
- MCP definitions show external resources
- Model config ties outcomes to a specific model

Without this, rewards and learnings will be wrong or incomplete.

## Single Agent vs Multi‑Agent
Tracing works for one agent or many agents.

For multi‑agent systems:
- Each agent emits its own events
- Each agent registers its own definition
- `parent_agent_id` links sub‑agents to the root

Marlo rebuilds the full tree from these ids.

## Task Boundaries
Each user task must be wrapped in a `task_start` and `task_end`.
This is how Marlo produces task‑level rewards.

If you only send a session‑level boundary, Marlo cannot score tasks.

## Reasoning Data
If your model returns reasoning, send it in `llm_call.reasoning`.
If it does not, send an empty object. The system should not crash.

## Where Tracing Happens
Tracing must run in the same process where the agent executes.

If you wrap a proxy or a router, you will not capture any real events.0:{"buildId":"v2rrxZYHf5YEmKKGKG3F2","rsc":["$","$1","c",{"children":[["$","div",null,{"className":"x:mx-auto x:flex x:max-w-(--nextra-content-width)","children":["$","$L2",null,{"value":[{"value":"What Tracing Captures","id":"what-tracing-captures","depth":2},{"value":"Why Tracing Is Required","id":"why-tracing-is-required","depth":2},{"value":"Agent Definition Is Not Optional","id":"agent-definition-is-not-optional","depth":2},{"value":"Single Agent vs Multi‑Agent","id":"single-agent-vs-multiagent","depth":2},{"value":"Task Boundaries","id":"task-boundaries","depth":2},{"value":"Reasoning Data","id":"reasoning-data","depth":2},{"value":"Where Tracing Happens","id":"where-tracing-happens","depth":2}],"children":[["$","$L3",null,{}],["$","$L4",null,{"metadata":{"sidebar_position":1,"title":"Tracing","filePath":"src/app/features/tracing/page.mdx","timestamp":1767344593000},"sourceCode":"$5","children":[["$","div",null,{"id":"nextra-skip-nav"}],["$","main",null,{"data-pagefind-body":true,"children":[["$","h1",null,{"className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-bold x:mt-2 x:text-4xl","children":["Tracing","$undefined"]}],"\n",["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Tracing is the raw data layer. It records what your agent did, in the exact order it happened."}],"\n","$L6","\n","$L7","\n","$L8","\n","$L9","\n","$La","\n","$Lb","\n","$Lc","\n","$Ld","\n","$Le","\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21"]}]]}]]}]}],null,"$L22"]}],"loading":null,"isPartial":false}
6:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Marlo does not infer or guess. If an event is not captured, it does not exist in the trace."}]
7:["$","h2",null,{"id":"what-tracing-captures","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["What Tracing Captures",["$","$L23",null,{"id":"what-tracing-captures"}]]}]
8:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"For every task, Marlo stores a full sequence of events:"}]
9:["$","ul",null,{"className":"x:[:is(ol,ul)_&]:my-[.75em] x:not-first:mt-[1.25em] x:list-disc x:ms-[1.5em]","children":["\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"agent_definition"}],": system prompt, tools, MCP servers, model config"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"task_start"}],": task text and metadata"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"llm_call"}],": messages, model params, response, usage, reasoning"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"tool_call"}],": tool name, input, output, error"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"log"}],": any extra metadata you want to attach"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"task_end"}],": status and final answer"]}],"\n"]}]
a:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Each event also includes:"}]
b:["$","ul",null,{"className":"x:[:is(ol,ul)_&]:my-[.75em] x:not-first:mt-[1.25em] x:list-disc x:ms-[1.5em]","children":["\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"agent_id"}],": the agent that produced the event"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"parent_agent_id"}],": the parent agent, if this is a sub‑agent"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"invocation_id"}],": trace id for the run"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"run_id"}],": session id"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"task_id"}],": task id inside the session"]}],"\n"]}]
c:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"This is enough to rebuild the agent tree and the full timeline for every task."}]
d:["$","h2",null,{"id":"why-tracing-is-required","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Why Tracing Is Required",["$","$L23",null,{"id":"why-tracing-is-required"}]]}]
e:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Rewards and learning are built from traces. If you skip tool calls or LLM calls, the judge sees an incomplete picture and the learning quality drops."}]
f:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"So these are mandatory:"}]
10:["$","ul",null,{"className":"x:[:is(ol,ul)_&]:my-[.75em] x:not-first:mt-[1.25em] x:list-disc x:ms-[1.5em]","children":["\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"llm_call"}]," for every model call"]}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"tool_call"}]," for every tool call"]}],"\n"]}]
11:["$","h2",null,{"id":"agent-definition-is-not-optional","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Agent Definition Is Not Optional",["$","$L23",null,{"id":"agent-definition-is-not-optional"}]]}]
12:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Marlo needs the full agent definition to judge and learn correctly:"}]
13:["$","ul",null,{"className":"x:[:is(ol,ul)_&]:my-[.75em] x:not-first:mt-[1.25em] x:list-disc x:ms-[1.5em]","children":["\n",["$","li",null,{"className":"x:my-[.5em]","children":"The system prompt gives the policy context"}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":"Tool definitions explain what tools exist and how to use them"}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":"MCP definitions show external resources"}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":"Model config ties outcomes to a specific model"}],"\n"]}]
14:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Without this, rewards and learnings will be wrong or incomplete."}]
15:["$","h2",null,{"id":"single-agent-vs-multiagent","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Single Agent vs Multi‑Agent",["$","$L23",null,{"id":"single-agent-vs-multiagent"}]]}]
16:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Tracing works for one agent or many agents."}]
17:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"For multi‑agent systems:"}]
18:["$","ul",null,{"className":"x:[:is(ol,ul)_&]:my-[.75em] x:not-first:mt-[1.25em] x:list-disc x:ms-[1.5em]","children":["\n",["$","li",null,{"className":"x:my-[.5em]","children":"Each agent emits its own events"}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":"Each agent registers its own definition"}],"\n",["$","li",null,{"className":"x:my-[.5em]","children":[["$","code",null,{"className":"nextra-code","dir":"ltr","children":"parent_agent_id"}]," links sub‑agents to the root"]}],"\n"]}]
19:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Marlo rebuilds the full tree from these ids."}]
1a:["$","h2",null,{"id":"task-boundaries","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Task Boundaries",["$","$L23",null,{"id":"task-boundaries"}]]}]
1b:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":["Each user task must be wrapped in a ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"task_start"}]," and ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"task_end"}],".\nThis is how Marlo produces task‑level rewards."]}]
1c:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"If you only send a session‑level boundary, Marlo cannot score tasks."}]
1d:["$","h2",null,{"id":"reasoning-data","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Reasoning Data",["$","$L23",null,{"id":"reasoning-data"}]]}]
1e:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":["If your model returns reasoning, send it in ",["$","code",null,{"className":"nextra-code","dir":"ltr","children":"llm_call.reasoning"}],".\nIf it does not, send an empty object. The system should not crash."]}]
1f:["$","h2",null,{"id":"where-tracing-happens","className":"x:tracking-tight x:text-slate-900 x:dark:text-slate-100 x:font-semibold x:target:animate-[fade-in_1.5s] x:mt-10 x:border-b x:pb-1 x:text-3xl nextra-border","children":["Where Tracing Happens",["$","$L23",null,{"id":"where-tracing-happens"}]]}]
20:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"Tracing must run in the same process where the agent executes."}]
21:["$","p",null,{"className":"x:not-first:mt-[1.25em] x:leading-7","children":"If you wrap a proxy or a router, you will not capture any real events."}]
22:["$","$L24",null,{"children":["$","$25",null,{"name":"Next.MetadataOutlet","children":"$@26"}]}]
26:null
